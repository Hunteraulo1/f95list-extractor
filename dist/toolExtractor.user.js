
// ==UserScript==
// @name         Tool Extractor
// @namespace    http://tampermonkey.net/
// @version      1.2.5
// @description  Extract all LC/F95z thread data
// @author       Hunteraulo
// @source       https://github.com/Hunteraulo1/f95list-extractor
// @downloadURL  https://raw.githubusercontent.com/Hunteraulo1/f95list-extractor/refs/heads/main/dist/toolExtractor.user.js
// @updateURL    https://raw.githubusercontent.com/Hunteraulo1/f95list-extractor/refs/heads/main/dist/toolExtractor.user.js
// @match        http*://lewdcorner.com/threads/*
// @match        http*://*.lewdcorner.com/threads/*
// @match        http*://f95zone.to/threads/*
// @match        http*://*.f95zone.to/threads/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=lewdcorner.com
// @grant        none
// ==/UserScript==

var c=()=>window.location.hostname==="f95zone.to";var d=()=>{let t=document.querySelectorAll(".tagItem")??[];return Array.from(t).map((n)=>n.textContent).join(", ")},u=()=>{let t=document.querySelector("title")?.textContent??"",n=document.querySelector("img.bbImage")?.getAttribute("src")??"",e=Number(window.location.pathname.split(".")[1]?.split("/")[0]),o=n?.replace("attachments.","preview.")??"",a=/.*-\s(.*?)\s\[/i,l=/([\w\\']+)(?=\s-)/gi,i=/\[([^\]]+)\]/gi,p=t.match(l)??[],T=t.match(a)??[],m=t.match(i)??[];console.log("versionMatch:",m);let v=T?.[1]??"",{status:N,type:M}=L(p),S=m?.[0]??"",w=d();return JSON.stringify({id:e,domain:"F95z",name:v,version:S,status:N,tags:w,type:M,ac:!1,link:e?`https://f95zone.to/threads/${e}`:"",image:o},null,0)},L=(t)=>{let n="",e="";for(let o of t){switch(o){case"Abandoned":n="ABANDONNÉ";break;case"Completed":n="TERMINÉ";break;default:n="EN COURS";break}switch(o){case"Ren'Py":e="RenPy";break;case"RPGM":e="RPGM";break;case"Unity":e="Unity";break;case"Unreal Engine":e="Unreal";break;case"Flash":e="Flash";break;case"HTML":e="HTML";break;case"QSP":e="QSP";break;case"Others":e="Autre";break}}return{status:n,type:e}};var x=()=>{let t=Array.from(document.querySelectorAll('script[type="application/ld+json"]')),n={};for(let{textContent:o}of t)try{let a=o?JSON.parse(o):{};Object.assign(n,a)}catch(a){console.error("Erreur lors du parsing JSON:",a)}let{mainEntity:e}=n;if(!e||typeof e!=="object"){console.error("mainEntity n'est pas défini ou mal formé.");return}return e},g=()=>{return x()?.keywords??""},b=()=>{let t=x(),n=document.querySelector(".p-title-value")?.innerText,e=Number(t?.url?.split(".")[2]?.split("/")[0]),o=document.querySelector("img.bbImage")?.getAttribute("src")??"",a=document.querySelector("dl[data-field='version'] > dd")?.textContent;console.log("\uD83D\uDE80 ~ extractDataLC ~ titleMatch:",n);let l=t?.headline?.match(/([^\[]*) /)?.[1]??"",{status:i,type:p}=z(n??"");return JSON.stringify({id:e,domain:"LewdCorner",name:l,version:a,status:i,tags:t?.keywords??"",type:p,ac:!1,link:e?`https://lewdcorner.com/threads/${e}`:"",image:o},null,0)},z=(t)=>{let n="",e="";if(t.includes("Abandoned"))n="ABANDONNÉ";else if(t.includes("Complete"))n="TERMINÉ";else n="EN COURS";if(t.includes("Ren'Py"))e="RenPy";else if(t.includes("RPGM"))e="RPGM";else if(t.includes("Unity"))e="Unity";else if(t.includes("Unreal Engine"))e="Unreal";else if(t.includes("Flash"))e="Flash";else if(t.includes("HTML"))e="HTML";else if(t.includes("QSP"))e="QSP";else if(t.includes("Others"))e="Autre";return{status:n,type:e}};var y=()=>c()?d():g(),f=()=>c()?u():b();var r=document.createElement("div"),E=()=>{r.className="extractor-panel",r.style.marginTop=c()?"8px":"14px",document.querySelector("nav")?.prepend(r),A(r),h("Extract tags",y),h("Extract all data",f)},A=(t)=>{let n=document.createElement("button");n.className="extractor-close",n.textContent="X",t.prepend(n),F(n)},F=(t)=>{t.addEventListener("click",()=>{r.style.display="none"})},h=(t,n)=>{let e=document.createElement("button");e.className="extractor-panelButton",e.textContent=t,r.append(e),e.addEventListener("click",()=>{O(n)})},O=(t)=>{navigator.clipboard.writeText(t()).then(()=>{console.info("Text copied to clipboard"),console.log(t())}).catch((n)=>console.error("Could not copy text",n))};var s=document.createElement("button"),C=()=>{s.className="extractor-button",s.style.marginTop=c()?"8px":"14px",s.textContent="E",document.querySelector("nav")?.prepend(s),P(s)},P=(t)=>{t.addEventListener("click",()=>{r.style.display="flex"})};var k=document.createElement("style");k.textContent=".extractor-button,.extractor-panel{background-color:#1e2022;top:0;right:0;position:absolute;margin-right:14px}.extractor-button{height:48px;width:48px;border-radius:99999px;z-index:1000;border:0;color:#ba4545;font-weight:700;font-size:24px;cursor:pointer}.extractor-button:hover{background-color:#1a1b1b}.extractor-panel{width:128px;border-radius:8px;z-index:1001;display:none;flex:flex;flex-direction:column;gap:1rem;padding:1rem}.extractor-panel .extractor-close,.extractor-panel .extractor-panelButton{height:16px;background-color:#37383a;color:#ba4545;font-weight:700;font-size:8px;cursor:pointer}.extractor-panel .extractor-close{width:16px;border-radius:99999px;align-self:end;border:0}.extractor-panel .extractor-close:hover,.extractor-panel .extractor-panelButton:hover{background-color:#2b2b2c}.extractor-panel .extractor-panelButton{width:100%;border:#ba4545;border-radius:8px}";document.head.appendChild(k);(()=>{C(),E()})();
